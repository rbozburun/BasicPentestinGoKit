package actions

import (
	"fmt"
	"log"
	"os"

	"github.com/urfave/cli"
)

func Commands() {
	app := &cli.App{
		Flags: []cli.Flag{
			cli.StringFlag{Name: "target", Usage: "target web url"},
			cli.BoolFlag{Name: "crossdomainxml", Usage: "check crossdomain.xml usage"},
			cli.BoolFlag{Name: "dirlisting", Usage: "check directory listing is enabled"},
		},

		Action: func(c *cli.Context) error {
			if c.String("target") != "" {
				target := c.String("target")

				// If the user added --crossdomainxml parameter run this block.
				if c.Bool("crossdomainxml") {
					CrossdomainFlag(target)
				}

				// TO DO
				//
				// Implement dirlisting, loginpagefinder, tracedetector, usedserverdetector functions.

			} else {
				fmt.Println("Target cannot be empty!")
			}

			return nil
		},
	}

	err := app.Run(os.Args)
	if err != nil {
		log.Fatal(err)
	}
}
